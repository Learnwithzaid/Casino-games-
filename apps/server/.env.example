# Server Configuration
NODE_ENV=development
PORT=3000
DATABASE_URL="file:./prisma/dev.db"
CORS_ORIGIN="http://localhost:3000,http://localhost:3001"

# JWT Configuration (CRITICAL: Use strong secrets in production!)
JWT_SECRET="your-super-strong-jwt-secret-key-change-in-production-min-256-bits"
JWT_ACCESS_EXPIRY="15m"
JWT_REFRESH_EXPIRY="7d"
JWT_ISSUER="payments-platform"

# Security Configuration
RATE_LIMIT_STORAGE_URL=""  # Optional Redis URL for distributed rate limiting
RATE_LIMIT_STRATEGY="memory"  # "memory" or "redis"
MAX_FAILED_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# Content Security Policy (CSP) Configuration
CSP_ENABLED=true
CSP_REPORT_URI=""  # Optional custom CSP report endpoint

# HTTP Strict Transport Security (HSTS) Configuration
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year in seconds

# Logging Configuration
LOG_LEVEL="info"
LOG_REDACT_PATHS="req.headers.authorization,req.headers.cookie,payload.password,payload.token,payload.secret,payload.hmac,response.headers[\"set-cookie\"]"

# Payment provider HMAC secrets (used for webhook signature verification)
PAYMENTS_HMAC_SECRET_JAZZCASH="change-me"
PAYMENTS_HMAC_SECRET_EASYPAISA="change-me"
PAYMENTS_HMAC_SECRET_SADAPAY="change-me"

# Optional IP allowlists (comma-separated). If empty, allow all.
PAYMENTS_WEBHOOK_IP_ALLOWLIST_JAZZCASH=""
PAYMENTS_WEBHOOK_IP_ALLOWLIST_EASYPAISA=""
PAYMENTS_WEBHOOK_IP_ALLOWLIST_SADAPAY=""

# Optional base URLs for redirect construction
JAZZCASH_BASE_URL="https://payments.jazzcash.com.pk/redirect"
EASYPAISA_BASE_URL="https://easypaisa.com.pk/redirect"
SADAPAY_BASE_URL="https://sadapay.pk/redirect"

# Retry Configuration
PAYMENTS_MAX_RETRIES=5
PAYMENTS_RETRY_BASE_DELAY_MS=500
PAYMENTS_RETRY_MAX_DELAY_MS=30000

# Development/Test Configuration
# WARNING: Never commit production secrets!
# TEST_DATABASE_URL="file:./prisma/test.db"